#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Run lint-staged (lint and type-check on staged files)
npx lint-staged

# Run tests for backend and frontend
# Only run if there are changes in backend or frontend directories
if git diff --cached --name-only | grep -qE '^(backend|frontend)/'; then
  echo "Running tests..."
  
  # Check if backend has changes
  if git diff --cached --name-only | grep -qE '^backend/'; then
    echo "Running backend tests..."
    cd backend && npm test || exit 1
    cd ..
  fi
  
  # Check if frontend has changes
  if git diff --cached --name-only | grep -qE '^frontend/'; then
    echo "Running frontend tests..."
    cd frontend && npm test || exit 1
    cd ..
  fi
fi

